{% extends 'base.html' %}

{% block title %}Delete Account - FreelanceHub{% endblock %}

{% block extra_css %}
<style>
    .delete-warning {
        background: rgba(220, 53, 69, 0.15);
        border: 2px solid rgba(220, 53, 69, 0.5);
        border-radius: 15px;
        padding: 2rem;
    }
    
    .danger-icon {
        font-size: 4rem;
        color: #dc3545;
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }
    
    .warning-list {
        background: var(--bg-tertiary);
        border-radius: 10px;
        padding: 1.5rem;
    }
    
    .warning-list li {
        padding: 0.5rem 0;
        border-bottom: 1px solid var(--border-color);
    }
    
    .warning-list li:last-child {
        border-bottom: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-body p-5">
                    <div class="text-center mb-4">
                        <i class="bi bi-exclamation-triangle-fill danger-icon"></i>
                        <h2 class="text-danger mt-3">Delete Account</h2>
                        <p class="text-muted">This action cannot be undone</p>
                    </div>
                    
                    <div class="delete-warning mb-4">
                        <h5 class="text-danger mb-3">
                            <i class="bi bi-shield-exclamation me-2"></i>Warning: Permanent Account Deletion
                        </h5>
                        <p class="mb-3">You are about to permanently delete your account. This will:</p>
                        
                        <div class="warning-list">
                            <ul class="mb-0">
                                <li><i class="bi bi-x-circle text-danger me-2"></i>Delete your profile and all personal information</li>
                                {% if user.user_type == 'freelancer' %}
                                <li><i class="bi bi-x-circle text-danger me-2"></i>Remove all your services from the platform</li>
                                <li><i class="bi bi-x-circle text-danger me-2"></i>Cancel all pending and accepted bookings</li>
                                {% else %}
                                <li><i class="bi bi-x-circle text-danger me-2"></i>Cancel all your active bookings</li>
                                {% endif %}
                                <li><i class="bi bi-x-circle text-danger me-2"></i>Delete all booking history and transaction records</li>
                                <li><i class="bi bi-x-circle text-danger me-2"></i>Remove all reviews you've written or received</li>
                                <li><i class="bi bi-x-circle text-danger me-2"></i>Permanently erase all your data from our database</li>
                                <li><i class="bi bi-x-circle text-danger me-2"></i>Make your username available for others to use</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="alert alert-danger">
                        <i class="bi bi-info-circle me-2"></i>
                        <strong>Important:</strong> Once deleted, your account cannot be recovered. All data will be permanently lost.
                    </div>
                    
                    <form method="post" id="deleteForm">
                        {% csrf_token %}
                        
                        <div class="mb-4">
                            <label for="password" class="form-label">
                                <strong>Enter your password to confirm deletion:</strong>
                            </label>
                            <input type="password" 
                                   name="password" 
                                   id="password" 
                                   class="form-control form-control-lg" 
                                   placeholder="Enter your password"
                                   required
                                   style="background: var(--bg-tertiary); color: var(--text-primary); border: 2px solid var(--border-color);">
                        </div>
                        
                        <div class="form-check mb-4">
                            <input class="form-check-input" 
                                   type="checkbox" 
                                   id="confirmDelete" 
                                   required>
                            <label class="form-check-label" for="confirmDelete">
                                I understand that this action is permanent and cannot be undone
                            </label>
                        </div>
                        
                        <div class="d-flex gap-3">
                            <button type="submit" 
                                    class="btn btn-danger btn-lg flex-grow-1"
                                    id="deleteButton"
                                    disabled>
                                <i class="bi bi-trash-fill me-2"></i>Yes, Delete My Account Permanently
                            </button>
                            <a href="{% url 'accounts:dashboard' %}" 
                               class="btn btn-secondary btn-lg">
                                <i class="bi bi-arrow-left me-2"></i>Cancel
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const confirmCheckbox = document.getElementById('confirmDelete');
    const deleteButton = document.getElementById('deleteButton');
    const deleteForm = document.getElementById('deleteForm');
    
    // Enable/disable delete button based on checkbox
    confirmCheckbox.addEventListener('change', function() {
        deleteButton.disabled = !this.checked;
    });
    
    // Confirm before submission
    deleteForm.addEventListener('submit', function(e) {
        if (!confirm('Are you absolutely sure? This will permanently delete your account and all associated data. This action CANNOT be undone!')) {
            e.preventDefault();
        }
    });
});
</script>
{% endblock %}
